library(tidyverse)
library(geosphere)
PU_lat <- c(40.889248, 40.903125, 40.82388, 40.886037, 40.8883, 40.857192, 40.7596, 40.75529, 40.868072, 40.873244, 40.840556, 40.874811, 40.702147, 40.712646, 40.6941, 40.702147, 40.739777, 40.721691, 40.770258, 40.793919, 40.721691, 40.670682, 40.608382, 40.775036, 40.702147)
PU_long <- c(-73.898583, -73.85062, -73.93647, -73.878751, -73.830834, -73.867615, -73.83003, -73.987495, -73.919899, -73.887138, -73.940133, -73.878855, -73.801109, -73.783817, -73.991777, -73.801109, -74.002578, -73.844521, -73.917843, -73.972323, -73.844521, -73.958131, -73.815925, -73.912034, -73.801109)
DO_lat <- c(40.702068, 40.632836, 40.666235, 40.668897, 40.632836, 40.713065, 40.755882, 40.752769, 40.603995, 40.577621, 40.675377, 40.577422, 40.712582, 40.577422, 40.650843, 40.706476, 40.645757, 40.712792, 40.577422, 40.577422, 40.634967, 40.661614, 40.580903, 40.703087, 40.706476 )
DO_long <- c(-74.013664, -73.947642, -73.884079, -73.932942, -73.947642, -74.004131, -74.00191, -73.979189, -73.755405, -73.961376, -73.872106, -73.981233, -74.009781, -73.981233, -73.949575, -74.011056, -73.901741, -73.951418, -73.981233, -73.981233, -74.023377, -73.962246, -73.835592, -74.012994, -74.011056)
df <- data_frame(PU_long, PU_lat, DO_long, DO_lat)

df1 <- df %>%
  mutate(Cost = 2.75)

mat1 <- matrix(c(-73.898583, -73.85062, -73.93647, -73.878751, -73.830834, -73.867615, -73.83003, -73.987495, -73.919899, -73.887138, -73.940133, -73.878855, -73.801109, -73.783817, -73.991777, -73.801109, -74.002578, -73.844521, -73.917843, -73.972323, -73.844521, -73.958131, -73.815925, -73.912034, -73.801109, 40.889248, 40.903125, 40.82388, 40.886037, 40.8883, 40.857192, 40.7596, 40.75529, 40.868072, 40.873244, 40.840556, 40.874811, 40.702147, 40.712646, 40.6941, 40.702147, 40.739777, 40.721691, 40.770258, 40.793919, 40.721691, 40.670682, 40.608382, 40.775036, 40.702147), ncol = 2)
mat2 <- matrix(c(-74.013664, -73.947642, -73.884079, -73.932942, -73.947642, -74.004131, -74.00191, -73.979189, -73.755405, -73.961376, -73.872106, -73.981233, -74.009781, -73.981233, -73.949575, -74.011056, -73.901741, -73.951418, -73.981233, -73.981233, -74.023377, -73.962246, -73.835592, -74.012994, -74.011056, 40.702068, 40.632836, 40.666235, 40.668897, 40.632836, 40.713065, 40.755882, 40.752769, 40.603995, 40.577621, 40.675377, 40.577422, 40.712582, 40.577422, 40.650843, 40.706476, 40.645757, 40.712792, 40.577422, 40.577422, 40.634967, 40.661614, 40.580903, 40.703087, 40.706476), ncol = 2)


df2<- df1 %>%
  mutate(Distance = distHaversine(mat1, mat2)) %>%
  mutate(Distance = Distance*0.000621371)